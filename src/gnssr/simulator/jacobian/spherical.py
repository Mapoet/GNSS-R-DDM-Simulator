#!/usr/bin/env python

import numpy as np
from gnssr.utils import *

import gnssr.simulator.jacobian.planar as planar

def delay_doppler_jacobian(delay, f_doppler, sim_config):
    delay_resolution = sim_config.delay_resolution
    doppler_resolution = sim_config.doppler_resolution

    r1_plus_delta_delay, r2_plus_delta_delay = \
            delay_doppler_to_local_surface(delay + delay_resolution/2, f_doppler, sim_config)

    r1_minus_delta_delay, r2_minus_delta_delay = \
            delay_doppler_to_local_surface(delay - delay_resolution/2, f_doppler, sim_config)

    r1_plus_delta_doppler, r2_plus_delta_doppler = \
            delay_doppler_to_local_surface(delay, f_doppler + doppler_resolution/2, sim_config)

    r1_minus_delta_doppler, r2_minus_delta_doppler = \
            delay_doppler_to_local_surface(delay, f_doppler - doppler_resolution/2, sim_config)

    j1_11 = (1/delay_resolution)*(
            r1_plus_delta_delay[0] - r1_minus_delta_delay[0]
            )
    j1_12 = (1/doppler_resolution)*(
            r1_plus_delta_doppler[0] - r1_minus_delta_doppler[0]
            )
    j1_21 = (1/delay_resolution)*(
            r1_plus_delta_delay[1] - r1_minus_delta_delay[1]
            )
    j1_22 = (1/doppler_resolution)*(
            r1_plus_delta_doppler[1] - r1_minus_delta_doppler[1]
            )
    j1 = j1_11*j1_22 - j1_12*j1_21

    j2_11 = (1/delay_resolution)*(
            r2_plus_delta_delay[0] - r2_minus_delta_delay[0]
            )
    j2_12 = (1/doppler_resolution)*(
            r2_plus_delta_doppler[0] - r2_minus_delta_doppler[0]
            )
    j2_21 = (1/delay_resolution)*(
            r2_plus_delta_delay[1] - r2_minus_delta_delay[1]
            )
    j2_22 = (1/doppler_resolution)*(
            r2_plus_delta_doppler[1] - r2_minus_delta_doppler[1]
            )
    j2 = j2_11*j2_22 - j2_12*j2_21

    x_real = r1_minus_delta_delay[0].real
    x_imag = r1_minus_delta_delay[0].imag

    j1_real = j1.real
    j1_imag = j1.imag

    j2_real = j2.real
    j2_imag = j2.imag

    for i, col in enumerate(x_imag):
        for j, val in enumerate(col):
            if val.imag == 0:
                x_imag[i,j-1] = 0
                break

    np.place(j1_real, x_imag != 0, 0)
    np.place(j2_real, x_imag != 0, 0)

    return np.absolute(j1_real).astype(float), np.absolute(j2_real).astype(float)

def myDD2SRF_spherical(tau, fd, h, gamma, Vt, Vr, wavelength, z_1, z_2):
    Vt_x = Vt[0];
    Vt_y = Vt[1];
    Vt_z = Vt[2];

    Vr_x = Vr[0];
    Vr_y = Vr[1];
    Vr_z = Vr[2];

    x_1 = (Vr_y*h + Vr_y*tau*np.sin(gamma) - Vr_y*h*np.cos(gamma)**2 + (Vr_z*h*np.sin(2*gamma))/2 - (Vr_z*z_1*np.sin(2*gamma))/2 + Vr_y*z_1*np.sin(gamma)**2)/(Vr_x*np.cos(gamma)*np.sin(gamma)) - ((Vt_y*np.cos(gamma)**2 - Vr_y + (Vt_z*np.sin(2*gamma))/2 + fd*wavelength*np.cos(gamma))*(Vr_x**2*tau*np.cos(gamma) + Vr_y**2*tau*np.cos(gamma) - Vr_x**2*h*np.tan(gamma) - Vr_y**2*h*np.tan(gamma) - (Vr_y*Vt_z*h)/8 + (Vr_z*Vt_y*h)/8 - (Vr_z*Vt_y*z_1)/8 - (Vr_x**2*tau)/np.cos(gamma) - (Vr_y**2*tau)/np.cos(gamma) + (Vr_x**2*h*np.sin(2*gamma))/2 + (Vr_y**2*h*np.sin(2*gamma))/2 + Vr_y*Vt_y*tau*np.cos(gamma) + Vr_x**2*np.sin(gamma)*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_1*np.sin(gamma)**2 + 8*Vr_y**2*z_1*np.sin(gamma)**2 + Vr_y*Vt_y*z_1*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_1*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_1*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_1*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_1*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_1*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_1*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_1**2 + Vr_y**2*z_1**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_1**2*np.cos(gamma)**2 + Vr_z**2*z_1**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_1 + 2*Vr_y**2*h*z_1 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_1**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_1*np.cos(gamma)**2 - 2*Vr_y**2*h*z_1*np.cos(gamma)**2 - 2*Vr_z**2*h*z_1*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_1*np.sin(gamma) + 2*Vr_y**2*tau*z_1*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_1*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) + Vr_y**2*np.sin(gamma)*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_1*np.sin(gamma)**2 + 8*Vr_y**2*z_1*np.sin(gamma)**2 + Vr_y*Vt_y*z_1*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_1*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_1*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_1*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_1*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_1*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_1*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_1**2 + Vr_y**2*z_1**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_1**2*np.cos(gamma)**2 + Vr_z**2*z_1**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_1 + 2*Vr_y**2*h*z_1 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_1**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_1*np.cos(gamma)**2 - 2*Vr_y**2*h*z_1*np.cos(gamma)**2 - 2*Vr_z**2*h*z_1*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_1*np.sin(gamma) + 2*Vr_y**2*tau*z_1*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_1*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) + (Vr_y*Vt_z*h*np.cos(4*gamma))/8 - (Vr_z*Vt_y*h*np.cos(4*gamma))/8 - Vr_y*Vt_y*tau*np.cos(gamma)**3 + (Vr_y*Vt_y*h*np.sin(2*gamma))/2 - Vr_y*Vr_z*h*np.sin(gamma)**2 + Vr_y*Vt_z*h*np.sin(gamma)**2 + (Vr_z*Vt_y*z_1*np.cos(4*gamma))/8 + Vr_y*Vt_z*tau*np.sin(gamma)**3 + Vr_y*Vr_z*z_1*np.sin(gamma)**2 + Vr_y*Vt_z*z_1*np.sin(gamma)**4 - (Vr_x**2*z_1*np.sin(gamma)**3)/np.cos(gamma) - (Vr_y**2*z_1*np.sin(gamma)**3)/np.cos(gamma) - Vr_z*fd*h*wavelength*np.cos(gamma)**3 + Vr_y*fd*h*wavelength*np.sin(gamma)**3 + Vr_z*fd*wavelength*z_1*np.cos(gamma)**3 + Vr_y*fd*wavelength*tau*np.sin(gamma)**2 + Vr_y*fd*wavelength*z_1*np.sin(gamma)**3 - Vr_y*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) + Vr_z*Vt_z*h*np.cos(gamma)*np.sin(gamma)**3 - Vr_x**2*np.cos(gamma)**2*np.sin(gamma)*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_1*np.sin(gamma)**2 + 8*Vr_y**2*z_1*np.sin(gamma)**2 + Vr_y*Vt_y*z_1*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_1*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_1*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_1*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_1*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_1*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_1*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_1**2 + Vr_y**2*z_1**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_1**2*np.cos(gamma)**2 + Vr_z**2*z_1**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_1 + 2*Vr_y**2*h*z_1 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_1**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_1*np.cos(gamma)**2 - 2*Vr_y**2*h*z_1*np.cos(gamma)**2 - 2*Vr_z**2*h*z_1*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_1*np.sin(gamma) + 2*Vr_y**2*tau*z_1*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_1*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) + Vt_y**2*np.cos(gamma)**4*np.sin(gamma)*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_1*np.sin(gamma)**2 + 8*Vr_y**2*z_1*np.sin(gamma)**2 + Vr_y*Vt_y*z_1*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_1*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_1*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_1*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_1*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_1*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_1*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_1**2 + Vr_y**2*z_1**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_1**2*np.cos(gamma)**2 + Vr_z**2*z_1**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_1 + 2*Vr_y**2*h*z_1 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_1**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_1*np.cos(gamma)**2 - 2*Vr_y**2*h*z_1*np.cos(gamma)**2 - 2*Vr_z**2*h*z_1*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_1*np.sin(gamma) + 2*Vr_y**2*tau*z_1*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_1*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) + Vr_y*Vt_y*z_1*np.cos(gamma)*np.sin(gamma)**3 - Vr_z*Vt_z*z_1*np.cos(gamma)*np.sin(gamma)**3 + Vr_z*fd*h*wavelength*np.cos(gamma) - Vr_z*fd*wavelength*z_1*np.cos(gamma) + Vt_z**2*np.cos(gamma)**2*np.sin(gamma)**3*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_1*np.sin(gamma)**2 + 8*Vr_y**2*z_1*np.sin(gamma)**2 + Vr_y*Vt_y*z_1*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_1*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_1*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_1*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_1*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_1*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_1*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_1**2 + Vr_y**2*z_1**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_1**2*np.cos(gamma)**2 + Vr_z**2*z_1**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_1 + 2*Vr_y**2*h*z_1 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_1**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_1*np.cos(gamma)**2 - 2*Vr_y**2*h*z_1*np.cos(gamma)**2 - 2*Vr_z**2*h*z_1*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_1*np.sin(gamma) + 2*Vr_y**2*tau*z_1*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_1*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) + fd**2*wavelength**2*np.cos(gamma)**2*np.sin(gamma)*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_1*np.sin(gamma)**2 + 8*Vr_y**2*z_1*np.sin(gamma)**2 + Vr_y*Vt_y*z_1*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_1*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_1*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_1*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_1*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_1*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_1*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_1**2 + Vr_y**2*z_1**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_1**2*np.cos(gamma)**2 + Vr_z**2*z_1**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_1 + 2*Vr_y**2*h*z_1 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_1**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_1*np.cos(gamma)**2 - 2*Vr_y**2*h*z_1*np.cos(gamma)**2 - 2*Vr_z**2*h*z_1*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_1*np.sin(gamma) + 2*Vr_y**2*tau*z_1*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_1*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) - 2*Vr_y*Vt_y*np.cos(gamma)**2*np.sin(gamma)*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_1*np.sin(gamma)**2 + 8*Vr_y**2*z_1*np.sin(gamma)**2 + Vr_y*Vt_y*z_1*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_1*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_1*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_1*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_1*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_1*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_1*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_1**2 + Vr_y**2*z_1**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_1**2*np.cos(gamma)**2 + Vr_z**2*z_1**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_1 + 2*Vr_y**2*h*z_1 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_1**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_1*np.cos(gamma)**2 - 2*Vr_y**2*h*z_1*np.cos(gamma)**2 - 2*Vr_z**2*h*z_1*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_1*np.sin(gamma) + 2*Vr_y**2*tau*z_1*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_1*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma)**2*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_1*np.sin(gamma)**2 + 8*Vr_y**2*z_1*np.sin(gamma)**2 + Vr_y*Vt_y*z_1*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_1*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_1*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_1*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_1*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_1*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_1*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_1**2 + Vr_y**2*z_1**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_1**2*np.cos(gamma)**2 + Vr_z**2*z_1**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_1 + 2*Vr_y**2*h*z_1 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_1**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_1*np.cos(gamma)**2 - 2*Vr_y**2*h*z_1*np.cos(gamma)**2 - 2*Vr_z**2*h*z_1*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_1*np.sin(gamma) + 2*Vr_y**2*tau*z_1*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_1*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma)**2*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_1*np.sin(gamma)**2 + 8*Vr_y**2*z_1*np.sin(gamma)**2 + Vr_y*Vt_y*z_1*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_1*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_1*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_1*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_1*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_1*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_1*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_1**2 + Vr_y**2*z_1**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_1**2*np.cos(gamma)**2 + Vr_z**2*z_1**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_1 + 2*Vr_y**2*h*z_1 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_1**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_1*np.cos(gamma)**2 - 2*Vr_y**2*h*z_1*np.cos(gamma)**2 - 2*Vr_z**2*h*z_1*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_1*np.sin(gamma) + 2*Vr_y**2*tau*z_1*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_1*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)**2*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_1*np.sin(gamma)**2 + 8*Vr_y**2*z_1*np.sin(gamma)**2 + Vr_y*Vt_y*z_1*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_1*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_1*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_1*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_1*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_1*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_1*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_1**2 + Vr_y**2*z_1**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_1**2*np.cos(gamma)**2 + Vr_z**2*z_1**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_1 + 2*Vr_y**2*h*z_1 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_1**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_1*np.cos(gamma)**2 - 2*Vr_y**2*h*z_1*np.cos(gamma)**2 - 2*Vr_z**2*h*z_1*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_1*np.sin(gamma) + 2*Vr_y**2*tau*z_1*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_1*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) - 2*Vr_y*fd*wavelength*np.cos(gamma)*np.sin(gamma)*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_1*np.sin(gamma)**2 + 8*Vr_y**2*z_1*np.sin(gamma)**2 + Vr_y*Vt_y*z_1*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_1*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_1*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_1*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_1*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_1*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_1*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_1**2 + Vr_y**2*z_1**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_1**2*np.cos(gamma)**2 + Vr_z**2*z_1**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_1 + 2*Vr_y**2*h*z_1 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_1**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_1*np.cos(gamma)**2 - 2*Vr_y**2*h*z_1*np.cos(gamma)**2 - 2*Vr_z**2*h*z_1*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_1*np.sin(gamma) + 2*Vr_y**2*tau*z_1*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_1*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3*np.sin(gamma)*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_1*np.sin(gamma)**2 + 8*Vr_y**2*z_1*np.sin(gamma)**2 + Vr_y*Vt_y*z_1*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_1*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_1*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_1*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_1*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_1*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_1*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_1**2 + Vr_y**2*z_1**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_1**2*np.cos(gamma)**2 + Vr_z**2*z_1**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_1 + 2*Vr_y**2*h*z_1 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_1**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_1*np.cos(gamma)**2 - 2*Vr_y**2*h*z_1*np.cos(gamma)**2 - 2*Vr_z**2*h*z_1*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_1*np.sin(gamma) + 2*Vr_y**2*tau*z_1*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_1*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2)))/(Vr_x*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)));

    x_2 = (Vr_y*h + Vr_y*tau*np.sin(gamma) - Vr_y*h*np.cos(gamma)**2 + (Vr_z*h*np.sin(2*gamma))/2 - (Vr_z*z_2*np.sin(2*gamma))/2 + Vr_y*z_2*np.sin(gamma)**2)/(Vr_x*np.cos(gamma)*np.sin(gamma)) - ((Vt_y*np.cos(gamma)**2 - Vr_y + (Vt_z*np.sin(2*gamma))/2 + fd*wavelength*np.cos(gamma))*(Vr_x**2*tau*np.cos(gamma) + Vr_y**2*tau*np.cos(gamma) - Vr_x**2*h*np.tan(gamma) - Vr_y**2*h*np.tan(gamma) - (Vr_y*Vt_z*h)/8 + (Vr_z*Vt_y*h)/8 - (Vr_z*Vt_y*z_2)/8 - (Vr_x**2*tau)/np.cos(gamma) - (Vr_y**2*tau)/np.cos(gamma) + (Vr_x**2*h*np.sin(2*gamma))/2 + (Vr_y**2*h*np.sin(2*gamma))/2 + Vr_y*Vt_y*tau*np.cos(gamma) - Vr_x**2*np.sin(gamma)*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_2*np.sin(gamma)**2 + 8*Vr_y**2*z_2*np.sin(gamma)**2 + Vr_y*Vt_y*z_2*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_2*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_2*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_2*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_2*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_2*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_2*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_2**2 + Vr_y**2*z_2**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_2**2*np.cos(gamma)**2 + Vr_z**2*z_2**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_2 + 2*Vr_y**2*h*z_2 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_2**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_2*np.cos(gamma)**2 - 2*Vr_y**2*h*z_2*np.cos(gamma)**2 - 2*Vr_z**2*h*z_2*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_2*np.sin(gamma) + 2*Vr_y**2*tau*z_2*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_2*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) - Vr_y**2*np.sin(gamma)*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_2*np.sin(gamma)**2 + 8*Vr_y**2*z_2*np.sin(gamma)**2 + Vr_y*Vt_y*z_2*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_2*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_2*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_2*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_2*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_2*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_2*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_2**2 + Vr_y**2*z_2**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_2**2*np.cos(gamma)**2 + Vr_z**2*z_2**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_2 + 2*Vr_y**2*h*z_2 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_2**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_2*np.cos(gamma)**2 - 2*Vr_y**2*h*z_2*np.cos(gamma)**2 - 2*Vr_z**2*h*z_2*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_2*np.sin(gamma) + 2*Vr_y**2*tau*z_2*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_2*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) + (Vr_y*Vt_z*h*np.cos(4*gamma))/8 - (Vr_z*Vt_y*h*np.cos(4*gamma))/8 - Vr_y*Vt_y*tau*np.cos(gamma)**3 + (Vr_y*Vt_y*h*np.sin(2*gamma))/2 - Vr_y*Vr_z*h*np.sin(gamma)**2 + Vr_y*Vt_z*h*np.sin(gamma)**2 + (Vr_z*Vt_y*z_2*np.cos(4*gamma))/8 + Vr_y*Vt_z*tau*np.sin(gamma)**3 + Vr_y*Vr_z*z_2*np.sin(gamma)**2 + Vr_y*Vt_z*z_2*np.sin(gamma)**4 - (Vr_x**2*z_2*np.sin(gamma)**3)/np.cos(gamma) - (Vr_y**2*z_2*np.sin(gamma)**3)/np.cos(gamma) - Vr_z*fd*h*wavelength*np.cos(gamma)**3 + Vr_y*fd*h*wavelength*np.sin(gamma)**3 + Vr_z*fd*wavelength*z_2*np.cos(gamma)**3 + Vr_y*fd*wavelength*tau*np.sin(gamma)**2 + Vr_y*fd*wavelength*z_2*np.sin(gamma)**3 - Vr_y*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) + Vr_z*Vt_z*h*np.cos(gamma)*np.sin(gamma)**3 + Vr_x**2*np.cos(gamma)**2*np.sin(gamma)*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_2*np.sin(gamma)**2 + 8*Vr_y**2*z_2*np.sin(gamma)**2 + Vr_y*Vt_y*z_2*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_2*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_2*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_2*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_2*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_2*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_2*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_2**2 + Vr_y**2*z_2**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_2**2*np.cos(gamma)**2 + Vr_z**2*z_2**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_2 + 2*Vr_y**2*h*z_2 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_2**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_2*np.cos(gamma)**2 - 2*Vr_y**2*h*z_2*np.cos(gamma)**2 - 2*Vr_z**2*h*z_2*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_2*np.sin(gamma) + 2*Vr_y**2*tau*z_2*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_2*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) - Vt_y**2*np.cos(gamma)**4*np.sin(gamma)*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_2*np.sin(gamma)**2 + 8*Vr_y**2*z_2*np.sin(gamma)**2 + Vr_y*Vt_y*z_2*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_2*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_2*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_2*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_2*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_2*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_2*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_2**2 + Vr_y**2*z_2**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_2**2*np.cos(gamma)**2 + Vr_z**2*z_2**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_2 + 2*Vr_y**2*h*z_2 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_2**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_2*np.cos(gamma)**2 - 2*Vr_y**2*h*z_2*np.cos(gamma)**2 - 2*Vr_z**2*h*z_2*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_2*np.sin(gamma) + 2*Vr_y**2*tau*z_2*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_2*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) + Vr_y*Vt_y*z_2*np.cos(gamma)*np.sin(gamma)**3 - Vr_z*Vt_z*z_2*np.cos(gamma)*np.sin(gamma)**3 + Vr_z*fd*h*wavelength*np.cos(gamma) - Vr_z*fd*wavelength*z_2*np.cos(gamma) - Vt_z**2*np.cos(gamma)**2*np.sin(gamma)**3*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_2*np.sin(gamma)**2 + 8*Vr_y**2*z_2*np.sin(gamma)**2 + Vr_y*Vt_y*z_2*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_2*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_2*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_2*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_2*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_2*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_2*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_2**2 + Vr_y**2*z_2**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_2**2*np.cos(gamma)**2 + Vr_z**2*z_2**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_2 + 2*Vr_y**2*h*z_2 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_2**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_2*np.cos(gamma)**2 - 2*Vr_y**2*h*z_2*np.cos(gamma)**2 - 2*Vr_z**2*h*z_2*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_2*np.sin(gamma) + 2*Vr_y**2*tau*z_2*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_2*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) - fd**2*wavelength**2*np.cos(gamma)**2*np.sin(gamma)*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_2*np.sin(gamma)**2 + 8*Vr_y**2*z_2*np.sin(gamma)**2 + Vr_y*Vt_y*z_2*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_2*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_2*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_2*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_2*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_2*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_2*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_2**2 + Vr_y**2*z_2**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_2**2*np.cos(gamma)**2 + Vr_z**2*z_2**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_2 + 2*Vr_y**2*h*z_2 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_2**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_2*np.cos(gamma)**2 - 2*Vr_y**2*h*z_2*np.cos(gamma)**2 - 2*Vr_z**2*h*z_2*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_2*np.sin(gamma) + 2*Vr_y**2*tau*z_2*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_2*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) + 2*Vr_y*Vt_y*np.cos(gamma)**2*np.sin(gamma)*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_2*np.sin(gamma)**2 + 8*Vr_y**2*z_2*np.sin(gamma)**2 + Vr_y*Vt_y*z_2*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_2*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_2*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_2*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_2*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_2*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_2*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_2**2 + Vr_y**2*z_2**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_2**2*np.cos(gamma)**2 + Vr_z**2*z_2**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_2 + 2*Vr_y**2*h*z_2 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_2**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_2*np.cos(gamma)**2 - 2*Vr_y**2*h*z_2*np.cos(gamma)**2 - 2*Vr_z**2*h*z_2*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_2*np.sin(gamma) + 2*Vr_y**2*tau*z_2*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_2*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) + 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma)**2*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_2*np.sin(gamma)**2 + 8*Vr_y**2*z_2*np.sin(gamma)**2 + Vr_y*Vt_y*z_2*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_2*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_2*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_2*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_2*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_2*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_2*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_2**2 + Vr_y**2*z_2**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_2**2*np.cos(gamma)**2 + Vr_z**2*z_2**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_2 + 2*Vr_y**2*h*z_2 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_2**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_2*np.cos(gamma)**2 - 2*Vr_y**2*h*z_2*np.cos(gamma)**2 - 2*Vr_z**2*h*z_2*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_2*np.sin(gamma) + 2*Vr_y**2*tau*z_2*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_2*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) - 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma)**2*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_2*np.sin(gamma)**2 + 8*Vr_y**2*z_2*np.sin(gamma)**2 + Vr_y*Vt_y*z_2*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_2*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_2*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_2*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_2*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_2*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_2*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_2**2 + Vr_y**2*z_2**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_2**2*np.cos(gamma)**2 + Vr_z**2*z_2**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_2 + 2*Vr_y**2*h*z_2 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_2**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_2*np.cos(gamma)**2 - 2*Vr_y**2*h*z_2*np.cos(gamma)**2 - 2*Vr_z**2*h*z_2*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_2*np.sin(gamma) + 2*Vr_y**2*tau*z_2*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_2*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) - 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)**2*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_2*np.sin(gamma)**2 + 8*Vr_y**2*z_2*np.sin(gamma)**2 + Vr_y*Vt_y*z_2*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_2*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_2*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_2*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_2*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_2*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_2*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_2**2 + Vr_y**2*z_2**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_2**2*np.cos(gamma)**2 + Vr_z**2*z_2**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_2 + 2*Vr_y**2*h*z_2 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_2**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_2*np.cos(gamma)**2 - 2*Vr_y**2*h*z_2*np.cos(gamma)**2 - 2*Vr_z**2*h*z_2*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_2*np.sin(gamma) + 2*Vr_y**2*tau*z_2*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_2*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) + 2*Vr_y*fd*wavelength*np.cos(gamma)*np.sin(gamma)*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_2*np.sin(gamma)**2 + 8*Vr_y**2*z_2*np.sin(gamma)**2 + Vr_y*Vt_y*z_2*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_2*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_2*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_2*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_2*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_2*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_2*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_2**2 + Vr_y**2*z_2**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_2**2*np.cos(gamma)**2 + Vr_z**2*z_2**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_2 + 2*Vr_y**2*h*z_2 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_2**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_2*np.cos(gamma)**2 - 2*Vr_y**2*h*z_2*np.cos(gamma)**2 - 2*Vr_z**2*h*z_2*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_2*np.sin(gamma) + 2*Vr_y**2*tau*z_2*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_2*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) - 2*Vt_y*fd*wavelength*np.cos(gamma)**3*np.sin(gamma)*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_2*np.sin(gamma)**2 + 8*Vr_y**2*z_2*np.sin(gamma)**2 + Vr_y*Vt_y*z_2*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_2*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_2*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_2*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_2*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_2*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_2*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_2**2 + Vr_y**2*z_2**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_2**2*np.cos(gamma)**2 + Vr_z**2*z_2**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_2 + 2*Vr_y**2*h*z_2 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_2**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_2*np.cos(gamma)**2 - 2*Vr_y**2*h*z_2*np.cos(gamma)**2 - 2*Vr_z**2*h*z_2*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_2*np.sin(gamma) + 2*Vr_y**2*tau*z_2*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_2*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2)))/(Vr_x*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)));

    y_1 = -(Vt_y**2*tau*(np.cos(gamma)**3 - np.cos(gamma)**5) - Vr_x**2*tau*(np.cos(gamma) - np.cos(gamma)**3) + (Vr_y**2*h*np.sin(2*gamma))/2 + fd**2*wavelength**2*tau*(np.cos(gamma) - np.cos(gamma)**3) - Vr_y*Vt_y*tau*(np.cos(gamma) - np.cos(gamma)**3) + Vr_x**2*np.sin(gamma)*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_1*np.sin(gamma)**2 + 8*Vr_y**2*z_1*np.sin(gamma)**2 + Vr_y*Vt_y*z_1*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_1*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_1*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_1*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_1*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_1*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_1*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_1**2 + Vr_y**2*z_1**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_1**2*np.cos(gamma)**2 + Vr_z**2*z_1**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_1 + 2*Vr_y**2*h*z_1 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_1**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_1*np.cos(gamma)**2 - 2*Vr_y**2*h*z_1*np.cos(gamma)**2 - 2*Vr_z**2*h*z_1*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_1*np.sin(gamma) + 2*Vr_y**2*tau*z_1*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_1*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) + Vr_y**2*np.sin(gamma)*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_1*np.sin(gamma)**2 + 8*Vr_y**2*z_1*np.sin(gamma)**2 + Vr_y*Vt_y*z_1*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_1*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_1*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_1*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_1*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_1*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_1*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_1**2 + Vr_y**2*z_1**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_1**2*np.cos(gamma)**2 + Vr_z**2*z_1**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_1 + 2*Vr_y**2*h*z_1 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_1**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_1*np.cos(gamma)**2 - 2*Vr_y**2*h*z_1*np.cos(gamma)**2 - 2*Vr_z**2*h*z_1*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_1*np.sin(gamma) + 2*Vr_y**2*tau*z_1*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_1*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) + Vr_y*Vt_z*h*(np.cos(4*gamma)/8 - 1/8) - Vr_z*Vt_y*h*(np.cos(4*gamma)/8 - 1/8) + Vr_z*Vt_y*z_1*(np.cos(4*gamma)/8 - 1/8) + Vt_y**2*h*np.cos(gamma)**3*np.sin(gamma) + Vt_z**2*h*np.cos(gamma)*np.sin(gamma)**3 + Vt_z**2*tau*np.cos(gamma)*np.sin(gamma)**4 + (fd**2*h*wavelength**2*np.sin(2*gamma))/2 - Vr_x**2*z_1*np.cos(gamma)*np.sin(gamma)**3 + Vt_z**2*z_1*np.cos(gamma)*np.sin(gamma)**5 - (Vr_y*Vt_y*h*np.sin(2*gamma))/2 - Vr_y*Vr_z*h*np.sin(gamma)**2 - Vr_y*Vt_z*h*np.sin(gamma)**2 + 2*Vt_y*Vt_z*tau*(np.sin(gamma)**3 - np.sin(gamma)**5) + 2*Vt_y*Vt_z*z_1*(np.sin(gamma)**4 - np.sin(gamma)**6) - Vr_y*Vt_z*tau*np.sin(gamma)**3 + Vr_y*Vr_z*z_1*np.sin(gamma)**2 - Vr_y*Vt_z*z_1*np.sin(gamma)**4 + Vt_y**2*z_1*np.cos(gamma)**3*np.sin(gamma)**3 - (Vt_y*Vt_z*h*(np.cos(4*gamma) - 1))/4 + 2*Vt_y*fd*wavelength*z_1*(np.sin(gamma)**3 - np.sin(gamma)**5) - Vr_y*fd*wavelength*tau*np.sin(gamma)**2 - Vr_y*fd*wavelength*z_1*np.sin(gamma)**3 + fd**2*wavelength**2*z_1*np.cos(gamma)*np.sin(gamma)**3 - Vr_y*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) + Vr_z*Vt_z*h*np.cos(gamma)*np.sin(gamma)**3 - Vr_x**2*np.cos(gamma)**2*np.sin(gamma)*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_1*np.sin(gamma)**2 + 8*Vr_y**2*z_1*np.sin(gamma)**2 + Vr_y*Vt_y*z_1*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_1*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_1*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_1*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_1*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_1*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_1*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_1**2 + Vr_y**2*z_1**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_1**2*np.cos(gamma)**2 + Vr_z**2*z_1**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_1 + 2*Vr_y**2*h*z_1 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_1**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_1*np.cos(gamma)**2 - 2*Vr_y**2*h*z_1*np.cos(gamma)**2 - 2*Vr_z**2*h*z_1*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_1*np.sin(gamma) + 2*Vr_y**2*tau*z_1*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_1*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) + Vt_y**2*np.cos(gamma)**4*np.sin(gamma)*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_1*np.sin(gamma)**2 + 8*Vr_y**2*z_1*np.sin(gamma)**2 + Vr_y*Vt_y*z_1*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_1*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_1*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_1*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_1*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_1*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_1*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_1**2 + Vr_y**2*z_1**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_1**2*np.cos(gamma)**2 + Vr_z**2*z_1**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_1 + 2*Vr_y**2*h*z_1 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_1**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_1*np.cos(gamma)**2 - 2*Vr_y**2*h*z_1*np.cos(gamma)**2 - 2*Vr_z**2*h*z_1*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_1*np.sin(gamma) + 2*Vr_y**2*tau*z_1*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_1*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) - Vr_y*Vt_y*z_1*np.cos(gamma)*np.sin(gamma)**3 - Vr_z*Vt_z*z_1*np.cos(gamma)*np.sin(gamma)**3 + Vr_z*fd*h*wavelength*(np.cos(gamma) - np.cos(gamma)**3) + 2*Vt_z*fd*h*wavelength*(np.cos(gamma) - np.cos(gamma)**3) - Vr_z*fd*wavelength*z_1*(np.cos(gamma) - np.cos(gamma)**3) - Vr_y*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 2*Vt_y*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) - Vr_y*fd*h*wavelength*np.sin(gamma) + Vt_z**2*np.cos(gamma)**2*np.sin(gamma)**3*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_1*np.sin(gamma)**2 + 8*Vr_y**2*z_1*np.sin(gamma)**2 + Vr_y*Vt_y*z_1*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_1*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_1*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_1*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_1*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_1*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_1*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_1**2 + Vr_y**2*z_1**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_1**2*np.cos(gamma)**2 + Vr_z**2*z_1**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_1 + 2*Vr_y**2*h*z_1 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_1**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_1*np.cos(gamma)**2 - 2*Vr_y**2*h*z_1*np.cos(gamma)**2 - 2*Vr_z**2*h*z_1*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_1*np.sin(gamma) + 2*Vr_y**2*tau*z_1*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_1*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) - 2*Vt_y*fd*wavelength*tau*(np.cos(4*gamma)/8 - 1/8) + 2*Vt_z*fd*wavelength*tau*np.cos(gamma)*np.sin(gamma)**3 + 2*Vt_z*fd*wavelength*z_1*np.cos(gamma)*np.sin(gamma)**4 + fd**2*wavelength**2*np.cos(gamma)**2*np.sin(gamma)*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_1*np.sin(gamma)**2 + 8*Vr_y**2*z_1*np.sin(gamma)**2 + Vr_y*Vt_y*z_1*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_1*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_1*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_1*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_1*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_1*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_1*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_1**2 + Vr_y**2*z_1**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_1**2*np.cos(gamma)**2 + Vr_z**2*z_1**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_1 + 2*Vr_y**2*h*z_1 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_1**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_1*np.cos(gamma)**2 - 2*Vr_y**2*h*z_1*np.cos(gamma)**2 - 2*Vr_z**2*h*z_1*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_1*np.sin(gamma) + 2*Vr_y**2*tau*z_1*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_1*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) - 2*Vr_y*Vt_y*np.cos(gamma)**2*np.sin(gamma)*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_1*np.sin(gamma)**2 + 8*Vr_y**2*z_1*np.sin(gamma)**2 + Vr_y*Vt_y*z_1*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_1*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_1*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_1*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_1*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_1*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_1*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_1**2 + Vr_y**2*z_1**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_1**2*np.cos(gamma)**2 + Vr_z**2*z_1**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_1 + 2*Vr_y**2*h*z_1 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_1**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_1*np.cos(gamma)**2 - 2*Vr_y**2*h*z_1*np.cos(gamma)**2 - 2*Vr_z**2*h*z_1*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_1*np.sin(gamma) + 2*Vr_y**2*tau*z_1*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_1*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma)**2*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_1*np.sin(gamma)**2 + 8*Vr_y**2*z_1*np.sin(gamma)**2 + Vr_y*Vt_y*z_1*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_1*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_1*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_1*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_1*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_1*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_1*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_1**2 + Vr_y**2*z_1**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_1**2*np.cos(gamma)**2 + Vr_z**2*z_1**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_1 + 2*Vr_y**2*h*z_1 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_1**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_1*np.cos(gamma)**2 - 2*Vr_y**2*h*z_1*np.cos(gamma)**2 - 2*Vr_z**2*h*z_1*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_1*np.sin(gamma) + 2*Vr_y**2*tau*z_1*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_1*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma)**2*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_1*np.sin(gamma)**2 + 8*Vr_y**2*z_1*np.sin(gamma)**2 + Vr_y*Vt_y*z_1*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_1*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_1*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_1*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_1*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_1*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_1*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_1**2 + Vr_y**2*z_1**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_1**2*np.cos(gamma)**2 + Vr_z**2*z_1**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_1 + 2*Vr_y**2*h*z_1 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_1**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_1*np.cos(gamma)**2 - 2*Vr_y**2*h*z_1*np.cos(gamma)**2 - 2*Vr_z**2*h*z_1*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_1*np.sin(gamma) + 2*Vr_y**2*tau*z_1*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_1*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)**2*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_1*np.sin(gamma)**2 + 8*Vr_y**2*z_1*np.sin(gamma)**2 + Vr_y*Vt_y*z_1*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_1*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_1*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_1*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_1*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_1*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_1*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_1**2 + Vr_y**2*z_1**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_1**2*np.cos(gamma)**2 + Vr_z**2*z_1**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_1 + 2*Vr_y**2*h*z_1 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_1**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_1*np.cos(gamma)**2 - 2*Vr_y**2*h*z_1*np.cos(gamma)**2 - 2*Vr_z**2*h*z_1*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_1*np.sin(gamma) + 2*Vr_y**2*tau*z_1*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_1*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) - 2*Vr_y*fd*wavelength*np.cos(gamma)*np.sin(gamma)*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_1*np.sin(gamma)**2 + 8*Vr_y**2*z_1*np.sin(gamma)**2 + Vr_y*Vt_y*z_1*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_1*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_1*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_1*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_1*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_1*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_1*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_1**2 + Vr_y**2*z_1**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_1**2*np.cos(gamma)**2 + Vr_z**2*z_1**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_1 + 2*Vr_y**2*h*z_1 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_1**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_1*np.cos(gamma)**2 - 2*Vr_y**2*h*z_1*np.cos(gamma)**2 - 2*Vr_z**2*h*z_1*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_1*np.sin(gamma) + 2*Vr_y**2*tau*z_1*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_1*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3*np.sin(gamma)*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_1*np.sin(gamma)**2 + 8*Vr_y**2*z_1*np.sin(gamma)**2 + Vr_y*Vt_y*z_1*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_1*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_1*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_1*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_1*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_1*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_1*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_1**2 + Vr_y**2*z_1**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_1**2*np.cos(gamma)**2 + Vr_z**2*z_1**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_1 + 2*Vr_y**2*h*z_1 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_1**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_1*np.cos(gamma)**2 - 2*Vr_y**2*h*z_1*np.cos(gamma)**2 - 2*Vr_z**2*h*z_1*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_1*np.sin(gamma) + 2*Vr_y**2*tau*z_1*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_1*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2))/(np.cos(gamma)*np.sin(gamma)*np.tan(gamma)*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)));

    y_2 =  (Vr_x**2*tau*(np.cos(gamma) - np.cos(gamma)**3) - Vt_y**2*tau*(np.cos(gamma)**3 - np.cos(gamma)**5) - (Vr_y**2*h*np.sin(2*gamma))/2 - fd**2*wavelength**2*tau*(np.cos(gamma) - np.cos(gamma)**3) + Vr_y*Vt_y*tau*(np.cos(gamma) - np.cos(gamma)**3) + Vr_x**2*np.sin(gamma)*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_2*np.sin(gamma)**2 + 8*Vr_y**2*z_2*np.sin(gamma)**2 + Vr_y*Vt_y*z_2*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_2*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_2*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_2*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_2*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_2*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_2*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_2**2 + Vr_y**2*z_2**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_2**2*np.cos(gamma)**2 + Vr_z**2*z_2**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_2 + 2*Vr_y**2*h*z_2 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_2**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_2*np.cos(gamma)**2 - 2*Vr_y**2*h*z_2*np.cos(gamma)**2 - 2*Vr_z**2*h*z_2*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_2*np.sin(gamma) + 2*Vr_y**2*tau*z_2*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_2*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) + Vr_y**2*np.sin(gamma)*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_2*np.sin(gamma)**2 + 8*Vr_y**2*z_2*np.sin(gamma)**2 + Vr_y*Vt_y*z_2*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_2*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_2*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_2*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_2*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_2*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_2*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_2**2 + Vr_y**2*z_2**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_2**2*np.cos(gamma)**2 + Vr_z**2*z_2**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_2 + 2*Vr_y**2*h*z_2 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_2**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_2*np.cos(gamma)**2 - 2*Vr_y**2*h*z_2*np.cos(gamma)**2 - 2*Vr_z**2*h*z_2*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_2*np.sin(gamma) + 2*Vr_y**2*tau*z_2*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_2*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) - Vr_y*Vt_z*h*(np.cos(4*gamma)/8 - 1/8) + Vr_z*Vt_y*h*(np.cos(4*gamma)/8 - 1/8) - Vr_z*Vt_y*z_2*(np.cos(4*gamma)/8 - 1/8) - Vt_y**2*h*np.cos(gamma)**3*np.sin(gamma) - Vt_z**2*h*np.cos(gamma)*np.sin(gamma)**3 - Vt_z**2*tau*np.cos(gamma)*np.sin(gamma)**4 - (fd**2*h*wavelength**2*np.sin(2*gamma))/2 + Vr_x**2*z_2*np.cos(gamma)*np.sin(gamma)**3 - Vt_z**2*z_2*np.cos(gamma)*np.sin(gamma)**5 + (Vr_y*Vt_y*h*np.sin(2*gamma))/2 + Vr_y*Vr_z*h*np.sin(gamma)**2 + Vr_y*Vt_z*h*np.sin(gamma)**2 - 2*Vt_y*Vt_z*tau*(np.sin(gamma)**3 - np.sin(gamma)**5) - 2*Vt_y*Vt_z*z_2*(np.sin(gamma)**4 - np.sin(gamma)**6) + Vr_y*Vt_z*tau*np.sin(gamma)**3 - Vr_y*Vr_z*z_2*np.sin(gamma)**2 + Vr_y*Vt_z*z_2*np.sin(gamma)**4 - Vt_y**2*z_2*np.cos(gamma)**3*np.sin(gamma)**3 + (Vt_y*Vt_z*h*(np.cos(4*gamma) - 1))/4 - 2*Vt_y*fd*wavelength*z_2*(np.sin(gamma)**3 - np.sin(gamma)**5) + Vr_y*fd*wavelength*tau*np.sin(gamma)**2 + Vr_y*fd*wavelength*z_2*np.sin(gamma)**3 - fd**2*wavelength**2*z_2*np.cos(gamma)*np.sin(gamma)**3 + Vr_y*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - Vr_z*Vt_z*h*np.cos(gamma)*np.sin(gamma)**3 - Vr_x**2*np.cos(gamma)**2*np.sin(gamma)*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_2*np.sin(gamma)**2 + 8*Vr_y**2*z_2*np.sin(gamma)**2 + Vr_y*Vt_y*z_2*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_2*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_2*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_2*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_2*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_2*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_2*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_2**2 + Vr_y**2*z_2**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_2**2*np.cos(gamma)**2 + Vr_z**2*z_2**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_2 + 2*Vr_y**2*h*z_2 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_2**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_2*np.cos(gamma)**2 - 2*Vr_y**2*h*z_2*np.cos(gamma)**2 - 2*Vr_z**2*h*z_2*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_2*np.sin(gamma) + 2*Vr_y**2*tau*z_2*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_2*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) + Vt_y**2*np.cos(gamma)**4*np.sin(gamma)*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_2*np.sin(gamma)**2 + 8*Vr_y**2*z_2*np.sin(gamma)**2 + Vr_y*Vt_y*z_2*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_2*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_2*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_2*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_2*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_2*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_2*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_2**2 + Vr_y**2*z_2**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_2**2*np.cos(gamma)**2 + Vr_z**2*z_2**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_2 + 2*Vr_y**2*h*z_2 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_2**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_2*np.cos(gamma)**2 - 2*Vr_y**2*h*z_2*np.cos(gamma)**2 - 2*Vr_z**2*h*z_2*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_2*np.sin(gamma) + 2*Vr_y**2*tau*z_2*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_2*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) + Vr_y*Vt_y*z_2*np.cos(gamma)*np.sin(gamma)**3 + Vr_z*Vt_z*z_2*np.cos(gamma)*np.sin(gamma)**3 - Vr_z*fd*h*wavelength*(np.cos(gamma) - np.cos(gamma)**3) - 2*Vt_z*fd*h*wavelength*(np.cos(gamma) - np.cos(gamma)**3) + Vr_z*fd*wavelength*z_2*(np.cos(gamma) - np.cos(gamma)**3) + Vr_y*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) - 2*Vt_y*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + Vr_y*fd*h*wavelength*np.sin(gamma) + Vt_z**2*np.cos(gamma)**2*np.sin(gamma)**3*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_2*np.sin(gamma)**2 + 8*Vr_y**2*z_2*np.sin(gamma)**2 + Vr_y*Vt_y*z_2*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_2*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_2*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_2*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_2*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_2*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_2*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_2**2 + Vr_y**2*z_2**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_2**2*np.cos(gamma)**2 + Vr_z**2*z_2**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_2 + 2*Vr_y**2*h*z_2 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_2**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_2*np.cos(gamma)**2 - 2*Vr_y**2*h*z_2*np.cos(gamma)**2 - 2*Vr_z**2*h*z_2*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_2*np.sin(gamma) + 2*Vr_y**2*tau*z_2*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_2*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) + 2*Vt_y*fd*wavelength*tau*(np.cos(4*gamma)/8 - 1/8) - 2*Vt_z*fd*wavelength*tau*np.cos(gamma)*np.sin(gamma)**3 - 2*Vt_z*fd*wavelength*z_2*np.cos(gamma)*np.sin(gamma)**4 + fd**2*wavelength**2*np.cos(gamma)**2*np.sin(gamma)*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_2*np.sin(gamma)**2 + 8*Vr_y**2*z_2*np.sin(gamma)**2 + Vr_y*Vt_y*z_2*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_2*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_2*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_2*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_2*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_2*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_2*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_2**2 + Vr_y**2*z_2**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_2**2*np.cos(gamma)**2 + Vr_z**2*z_2**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_2 + 2*Vr_y**2*h*z_2 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_2**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_2*np.cos(gamma)**2 - 2*Vr_y**2*h*z_2*np.cos(gamma)**2 - 2*Vr_z**2*h*z_2*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_2*np.sin(gamma) + 2*Vr_y**2*tau*z_2*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_2*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) - 2*Vr_y*Vt_y*np.cos(gamma)**2*np.sin(gamma)*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_2*np.sin(gamma)**2 + 8*Vr_y**2*z_2*np.sin(gamma)**2 + Vr_y*Vt_y*z_2*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_2*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_2*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_2*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_2*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_2*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_2*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_2**2 + Vr_y**2*z_2**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_2**2*np.cos(gamma)**2 + Vr_z**2*z_2**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_2 + 2*Vr_y**2*h*z_2 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_2**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_2*np.cos(gamma)**2 - 2*Vr_y**2*h*z_2*np.cos(gamma)**2 - 2*Vr_z**2*h*z_2*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_2*np.sin(gamma) + 2*Vr_y**2*tau*z_2*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_2*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma)**2*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_2*np.sin(gamma)**2 + 8*Vr_y**2*z_2*np.sin(gamma)**2 + Vr_y*Vt_y*z_2*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_2*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_2*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_2*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_2*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_2*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_2*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_2**2 + Vr_y**2*z_2**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_2**2*np.cos(gamma)**2 + Vr_z**2*z_2**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_2 + 2*Vr_y**2*h*z_2 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_2**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_2*np.cos(gamma)**2 - 2*Vr_y**2*h*z_2*np.cos(gamma)**2 - 2*Vr_z**2*h*z_2*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_2*np.sin(gamma) + 2*Vr_y**2*tau*z_2*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_2*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma)**2*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_2*np.sin(gamma)**2 + 8*Vr_y**2*z_2*np.sin(gamma)**2 + Vr_y*Vt_y*z_2*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_2*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_2*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_2*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_2*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_2*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_2*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_2**2 + Vr_y**2*z_2**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_2**2*np.cos(gamma)**2 + Vr_z**2*z_2**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_2 + 2*Vr_y**2*h*z_2 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_2**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_2*np.cos(gamma)**2 - 2*Vr_y**2*h*z_2*np.cos(gamma)**2 - 2*Vr_z**2*h*z_2*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_2*np.sin(gamma) + 2*Vr_y**2*tau*z_2*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_2*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)**2*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_2*np.sin(gamma)**2 + 8*Vr_y**2*z_2*np.sin(gamma)**2 + Vr_y*Vt_y*z_2*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_2*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_2*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_2*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_2*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_2*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_2*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_2**2 + Vr_y**2*z_2**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_2**2*np.cos(gamma)**2 + Vr_z**2*z_2**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_2 + 2*Vr_y**2*h*z_2 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_2**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_2*np.cos(gamma)**2 - 2*Vr_y**2*h*z_2*np.cos(gamma)**2 - 2*Vr_z**2*h*z_2*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_2*np.sin(gamma) + 2*Vr_y**2*tau*z_2*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_2*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) - 2*Vr_y*fd*wavelength*np.cos(gamma)*np.sin(gamma)*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_2*np.sin(gamma)**2 + 8*Vr_y**2*z_2*np.sin(gamma)**2 + Vr_y*Vt_y*z_2*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_2*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_2*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_2*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_2*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_2*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_2*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_2**2 + Vr_y**2*z_2**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_2**2*np.cos(gamma)**2 + Vr_z**2*z_2**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_2 + 2*Vr_y**2*h*z_2 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_2**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_2*np.cos(gamma)**2 - 2*Vr_y**2*h*z_2*np.cos(gamma)**2 - 2*Vr_z**2*h*z_2*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_2*np.sin(gamma) + 2*Vr_y**2*tau*z_2*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_2*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3*np.sin(gamma)*np.tan(gamma)*((8*Vr_x**2*h + 8*Vr_y**2*h + 8*Vr_x**2*tau*np.sin(gamma) + 8*Vr_y**2*tau*np.sin(gamma) - 8*Vr_x**2*h*np.cos(gamma)**2 - 8*Vr_y**2*h*np.cos(gamma)**2 + 8*Vr_x**2*z_2*np.sin(gamma)**2 + 8*Vr_y**2*z_2*np.sin(gamma)**2 + Vr_y*Vt_y*z_2*(np.cos(4*gamma) - 1) - Vr_z*Vt_z*z_2*(np.cos(4*gamma) - 1) - 8*Vr_y*Vt_z*tau*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*Vt_y*tau*(np.sin(gamma) - np.sin(gamma)**3) - 8*Vr_y*Vt_y*h*np.cos(gamma)**2 + 8*Vr_y*Vt_y*h*np.cos(gamma)**4 + 4*Vr_y*Vr_z*h*np.sin(2*gamma) - 4*Vr_y*Vt_z*h*np.sin(2*gamma) - 4*Vr_y*Vr_z*z_2*np.sin(2*gamma) + Vr_z*Vt_z*h*(np.cos(4*gamma) - 1) + 8*Vr_y*fd*h*wavelength*np.cos(gamma)**3 - 4*Vr_y*fd*wavelength*tau*np.sin(2*gamma) + 8*Vr_y*Vt_z*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_z*Vt_y*h*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*Vt_z*z_2*np.cos(gamma)*np.sin(gamma)**3 + 8*Vr_z*Vt_y*z_2*np.cos(gamma)**3*np.sin(gamma) - 8*Vr_y*fd*wavelength*z_2*(np.cos(gamma) - np.cos(gamma)**3) - 8*Vr_y*fd*h*wavelength*np.cos(gamma) - 8*Vr_z*fd*h*wavelength*(np.sin(gamma) - np.sin(gamma)**3) + 8*Vr_z*fd*wavelength*z_2*(np.sin(gamma) - np.sin(gamma)**3))**2/(64*np.sin(gamma)**2*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma))**2) - (Vr_x**2*h**2 + Vr_y**2*h**2 + Vr_x**2*tau**2 + Vr_y**2*tau**2 + Vr_x**2*z_2**2 + Vr_y**2*z_2**2 - Vr_y**2*h**2*np.cos(gamma)**2 + Vr_z**2*h**2*np.cos(gamma)**2 - Vr_y**2*z_2**2*np.cos(gamma)**2 + Vr_z**2*z_2**2*np.cos(gamma)**2 + 2*Vr_x**2*h*z_2 + 2*Vr_y**2*h*z_2 + Vr_y*Vr_z*h**2*np.sin(2*gamma) - Vr_y*Vr_z*z_2**2*np.sin(2*gamma) - 4*Vr_x**2*h*z_2*np.cos(gamma)**2 - 2*Vr_y**2*h*z_2*np.cos(gamma)**2 - 2*Vr_z**2*h*z_2*np.cos(gamma)**2 + 2*Vr_x**2*h*tau*np.sin(gamma) + 2*Vr_y**2*h*tau*np.sin(gamma) + 2*Vr_x**2*tau*z_2*np.sin(gamma) + 2*Vr_y**2*tau*z_2*np.sin(gamma) + 2*Vr_y*Vr_z*h*tau*np.cos(gamma) - 2*Vr_y*Vr_z*tau*z_2*np.cos(gamma))/(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)))**(1/2))/(np.cos(gamma)*np.sin(gamma)*np.tan(gamma)*(Vt_z**2*np.cos(gamma)**2 - Vr_x**2*np.cos(gamma)**2 + Vt_y**2*np.cos(gamma)**4 - Vt_z**2*np.cos(gamma)**4 + Vr_x**2 + Vr_y**2 + fd**2*wavelength**2*np.cos(gamma)**2 - 2*Vr_y*Vt_y*np.cos(gamma)**2 + 2*Vt_y*Vt_z*np.cos(gamma)**3*np.sin(gamma) - 2*Vr_y*fd*wavelength*np.cos(gamma) - 2*Vr_y*Vt_z*np.cos(gamma)*np.sin(gamma) + 2*Vt_y*fd*wavelength*np.cos(gamma)**3 + 2*Vt_z*fd*wavelength*np.cos(gamma)**2*np.sin(gamma)));

    return x_1, y_1, x_2, y_2

def delay_doppler_to_local_surface(delay, f_doppler, sim_config):

    x0_1 = planar.x_delay_doppler_1(delay, f_doppler, sim_config) 
    y0_1 = planar.y_delay_doppler_1(delay, f_doppler, sim_config) 
    x0_2 = planar.x_delay_doppler_2(delay, f_doppler, sim_config) 
    y0_2 = planar.y_delay_doppler_2(delay, f_doppler, sim_config) 

    #print("planar solution: {0}, {1} ---- {2}, {3}\n".format(x0_1, y0_1, x0_2, y0_2))

    Re = 6371.0e3;
    z1_old = np.sqrt(Re**2 - x0_1**2 - y0_1**2) - Re;
    z2_old = np.sqrt(Re**2 - x0_2**2 - y0_2**2) - Re;

    r1_old = np.array([x0_1, y0_1, z1_old]);
    r2_old = np.array([x0_2, y0_2, z2_old]);

    rel_err_z1 = np.inf;
    rel_err_z2 = np.inf;
    iter = 1;
    max_num_iter = 20;
    step_tol = 0.1;

    x1 = x0_1
    x2 = x0_2
    y1 = y0_1
    y2 = y0_2

    while (iter < max_num_iter):# and max(rel_err_z1,rel_err_z2) > 0.001 ):

        #   - tau           Delay coordinate with respect the specular point delay [meter]
        #   - fd            Doppler shift coordinate [hertz]
        #   - h             Receiver height over the flat Earth surface [meter]
        #   - gamma         Transmitter elevation [radian]
        #   - Vt            Transmitter velocity in the SRF
        #   - Vr            Receiver velocity in the SRF 
        #   - lambda        Operating wavelength [meter]
        h = sim_config.h_r
        tau = delay*light_speed
        fd = f_doppler
        gamma = sim_config.elevation
        Vt = sim_config.v_t
        Vr = sim_config.v_r
        wavelength = light_speed/sim_config.f_carrier

        x1_new, y1_new, x2_new, y2_new = myDD2SRF_spherical(tau, fd, h, gamma, Vt, Vr, wavelength, r1_old[2], r2_old[2])

        z1_new = np.sqrt(Re**2 - x1_new**2 - y1_new**2) - Re
        z2_new = np.sqrt(Re**2 - x2_new**2 - y2_new**2) - Re

        np.place(z1_new, np.logical_or(
            x1_new.imag != 0,
            y1_new.imag != 0)
            , 0)
        np.place(z2_new, np.logical_or(
            x2_new.imag != 0,
            y2_new.imag != 0)
            , 0)

        rel_err_z1 = abs(z1_new - z1_old)/abs(z1_old)
        rel_err_z2 = abs(z2_new - z2_old)/abs(z2_old)

        np.place(rel_err_z1, z1_old == 0, 0.0)
        np.place(rel_err_z2, z2_old == 0, 0.0)

        rel_err_z1 = np.amax(rel_err_z1)
        rel_err_z2 = np.amax(rel_err_z2)

        r1_new = np.array([x1_new, y1_new, z1_new])
        r2_new = np.array([x2_new, y2_new, z2_new])
        r1_old = r1_new
        r2_old = r2_new
        z1_old = z1_new
        z2_old = z2_new
        iter = iter + 1

        x1 = x1_new
        x2 = x2_new
        y1 = y1_new
        y2 = y2_new
        print ("spherical it: {0} - err: {1}\n".format(iter, rel_err_z1))

    #print("spherical solution: {0}, {1} ---- {2}, {3}".format(x1, y1, x2, y2))
    z1_new = np.sqrt(Re**2 - x1_new**2 - y1_new**2) - Re
    z2_new = np.sqrt(Re**2 - x2_new**2 - y2_new**2) - Re

    return np.array([x1_new, y1_new, z1_new]), np.array([x2_new, y2_new, z2_new])


